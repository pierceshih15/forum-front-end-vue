{"version":3,"sources":["webpack:///./node_modules/core-js/modules/_strict-method.js","webpack:///./node_modules/core-js/modules/es6.array.sort.js","webpack:///./src/views/RestaurantsTop.vue?01ce","webpack:///src/views/RestaurantsTop.vue","webpack:///./src/views/RestaurantsTop.vue?3181","webpack:///./src/views/RestaurantsTop.vue"],"names":["fails","__webpack_require__","module","exports","method","arg","call","$export","aFunction","toObject","$sort","sort","test","P","F","undefined","comparefn","this","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_l","restaurant","key","id","staticStyle","max-width","margin","attrs","to","name","params","src","_f","image","_s","FavoriteCount","description","href","type","on","click","$event","stopPropagation","preventDefault","deleteFavorite","addFavorite","staticRenderFns","RestaurantsTopvue_type_script_lang_js_","components","NavTabs","Spinner","mixins","data","restaurantsTop","isLoading","created","fetchRestaurantsTop","methods","_fetchRestaurantsTop","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","statusText","wrap","_context","prev","next","restaurants","getTopRestaurants","sent","Error","t0","helpers","fire","title","stop","apply","arguments","_addFavorite","_callee2","restaurantId","_ref2","_context2","users","status","map","_objectSpread","isFavorited","a","b","_x","_deleteFavorite","_callee3","_ref3","_context3","_x2","views_RestaurantsTopvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__"],"mappings":"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","file":"js/chunk-6fa82215.6843ee11.js","sourcesContent":["'use strict';\nvar fails = require('./_fails');\n\nmodule.exports = function (method, arg) {\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call\n    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);\n  });\n};\n","'use strict';\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar toObject = require('./_to-object');\nvar fails = require('./_fails');\nvar $sort = [].sort;\nvar test = [1, 2, 3];\n\n$export($export.P + $export.F * (fails(function () {\n  // IE8-\n  test.sort(undefined);\n}) || !fails(function () {\n  // V8 bug\n  test.sort(null);\n  // Old WebKit\n}) || !require('./_strict-method')($sort)), 'Array', {\n  // 22.1.3.25 Array.prototype.sort(comparefn)\n  sort: function sort(comparefn) {\n    return comparefn === undefined\n      ? $sort.call(toObject(this))\n      : $sort.call(toObject(this), aFunction(comparefn));\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5\"},[_c('NavTabs'),(_vm.isLoading)?_c('Spinner'):[_c('h1',{staticClass:\"mt-5\"},[_vm._v(\"人氣餐廳\")]),_c('hr'),_vm._l((_vm.restaurantsTop),function(restaurant){return _c('div',{key:restaurant.id,staticClass:\"card mb-3\",staticStyle:{\"max-width\":\"540px\",\"margin\":\"auto\"}},[_c('div',{staticClass:\"row no-gutters\"},[_c('div',{staticClass:\"col-md-4\"},[_c('router-link',{attrs:{\"to\":{name:'restaurant',params:{id:restaurant.id}}}},[_c('img',{staticClass:\"card-img\",attrs:{\"src\":_vm._f(\"emptyImage\")(restaurant.image)}})])],1),_c('div',{staticClass:\"col-md-8\"},[_c('div',{staticClass:\"card-body\"},[_c('h5',{staticClass:\"card-title\"},[_vm._v(_vm._s(restaurant.name))]),_c('span',{staticClass:\"badge badge-secondary\"},[_vm._v(\"收藏數：\"+_vm._s(restaurant.FavoriteCount))]),_c('p',{staticClass:\"card-text\"},[_vm._v(_vm._s(restaurant.description))]),_c('a',{staticClass:\"btn btn-primary mr-2\",attrs:{\"href\":\"#\"}},[_vm._v(\"Show\")]),(restaurant.isFavorited)?_c('button',{staticClass:\"btn btn-danger mr-2\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.deleteFavorite(restaurant.id)}}},[_vm._v(\"移除最愛\")]):_c('button',{staticClass:\"btn btn-primary\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.addFavorite(restaurant.id)}}},[_vm._v(\"加到最愛\")])])])])])})]],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container py-5\">\n    <NavTabs />\n\n    <Spinner v-if=\"isLoading\" />\n    <template v-else>\n      <h1 class=\"mt-5\">人氣餐廳</h1>\n      <hr />\n      <div\n        v-for=\"restaurant in restaurantsTop\"\n        :key=\"restaurant.id\"\n        class=\"card mb-3\"\n        style=\"max-width: 540px;margin: auto;\"\n      >\n        <div class=\"row no-gutters\">\n          <div class=\"col-md-4\">\n            <router-link :to=\"{name:'restaurant',params:{id:restaurant.id}}\">\n              <img class=\"card-img\" :src=\"restaurant.image | emptyImage\" />\n            </router-link>\n          </div>\n          <div class=\"col-md-8\">\n            <div class=\"card-body\">\n              <h5 class=\"card-title\">{{restaurant.name}}</h5>\n              <span class=\"badge badge-secondary\">收藏數：{{restaurant.FavoriteCount}}</span>\n              <p class=\"card-text\">{{restaurant.description}}</p>\n              <a href=\"#\" class=\"btn btn-primary mr-2\">Show</a>\n\n              <button\n                v-if=\"restaurant.isFavorited\"\n                type=\"button\"\n                class=\"btn btn-danger mr-2\"\n                @click.stop.prevent=\"deleteFavorite(restaurant.id)\"\n              >移除最愛</button>\n              <button\n                v-else\n                type=\"button\"\n                class=\"btn btn-primary\"\n                @click.stop.prevent=\"addFavorite(restaurant.id)\"\n              >加到最愛</button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport Spinner from './../components/Spinner'\nimport NavTabs from './../components/NavTabs'\nimport restaurantsAPI from './../apis/restaurants'\nimport usersAPI from './../apis/users'\nimport { Toast } from './../utils/helpers'\nimport { emptyImageFilter } from './../utils/mixins'\n\nexport default {\n  components: {\n    NavTabs,\n    Spinner\n  },\n  mixins: [emptyImageFilter],\n  data() {\n    return {\n      restaurantsTop: [],\n      isLoading: true\n    }\n  },\n  created() {\n    this.fetchRestaurantsTop()\n  },\n  methods: {\n    async fetchRestaurantsTop() {\n      try {\n        this.isLoading = true\n        const { data, statusText } = await restaurantsAPI.getTopRestaurants()\n\n        if (statusText !== 'OK') {\n          throw new Error(statusText)\n        }\n\n        this.restaurantsTop = data.restaurants\n        this.isLoading = false\n      } catch (error) {\n        this.isLoading = false\n        Toast.fire({\n          type: 'error',\n          title: '無法取得人氣餐廳，請稍後再試'\n        })\n      }\n    },\n    async addFavorite(restaurantId) {\n      try {\n        const { data, statusText } = await usersAPI.addFavorite({\n          restaurantId\n        })\n\n        if (statusText !== 'OK' || data.status !== 'success') {\n          throw new Error(statusText)\n        }\n\n        this.restaurantsTop = this.restaurantsTop\n          .map(restaurant => {\n            if (restaurant.id !== restaurantId) {\n              return restaurant\n            }\n\n            return {\n              ...restaurant,\n              FavoriteCount: restaurant.FavoriteCount + 1,\n              isFavorited: true\n            }\n          })\n          .sort((a, b) => b.FavoriteCount - a.FavoriteCount)\n      } catch (error) {\n        Toast.fire({\n          type: 'error',\n          title: '無法將餐廳加到最愛，請稍後再試'\n        })\n      }\n    },\n    async deleteFavorite(restaurantId) {\n      try {\n        const { data, statusText } = await usersAPI.deleteFavorite({\n          restaurantId\n        })\n\n        if (statusText !== 'OK' || data.status !== 'success') {\n          throw new Error(statusText)\n        }\n\n        this.restaurantsTop = this.restaurantsTop\n          .map(restaurant => {\n            if (restaurant.id !== restaurantId) {\n              return restaurant\n            }\n\n            return {\n              ...restaurant,\n              FavoriteCount: restaurant.FavoriteCount - 1,\n              isFavorited: false\n            }\n          })\n          .sort((a, b) => b.FavoriteCount - a.FavoriteCount)\n      } catch (error) {\n        Toast.fire({\n          type: 'error',\n          title: '無法將餐廳移除最愛，請稍後再試'\n        })\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RestaurantsTop.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RestaurantsTop.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RestaurantsTop.vue?vue&type=template&id=7f1a59c4&\"\nimport script from \"./RestaurantsTop.vue?vue&type=script&lang=js&\"\nexport * from \"./RestaurantsTop.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}