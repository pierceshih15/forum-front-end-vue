{"version":3,"sources":["webpack:///./src/views/AdminUsers.vue?737c","webpack:///src/views/AdminUsers.vue","webpack:///./src/views/AdminUsers.vue?6bf7","webpack:///./src/views/AdminUsers.vue","webpack:///./src/apis/admin.js","webpack:///./src/components/AdminNav.vue?27de","webpack:///./src/components/AdminNav.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","scope","_v","width","_l","user","key","id","_s","email","isAdmin","currentUser","type","on","click","$event","stopPropagation","preventDefault","toggleUserRole","userId","_e","staticRenderFns","AdminUsersvue_type_script_lang_js_","components","AdminNav","Spinner","data","users","isLoading","computed","_objectSpread","Object","vuex_esm","created","fetchUsers","methods","_fetchUsers","asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","statusText","wrap","_context","prev","next","admin","get","sent","Error","t0","helpers","fire","title","stop","apply","arguments","_toggleUserRole","_callee2","_ref2","willBeAdmin","_ref3","_context2","update","toString","status","map","_x","views_AdminUsersvue_type_script_lang_js_","component","componentNormalizer","__webpack_exports__","categories","apiHelper","create","name","post","categoryId","put","concat","delete","restaurants","getDetail","_ref4","restaurantId","_ref5","formData","_ref6","_ref7","_ref8","to","script"],"mappings":"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","file":"js/chunk-e06d6a3a.07924662.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container py-5\"},[_c('AdminNav'),(_vm.isLoading)?_c('Spinner'):_c('table',{staticClass:\"table\"},[_c('thead',{staticClass:\"thead-dark\"},[_c('tr',[_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"#\")]),_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"Email\")]),_c('th',{attrs:{\"scope\":\"col\"}},[_vm._v(\"Role\")]),_c('th',{attrs:{\"scope\":\"col\",\"width\":\"180\"}},[_vm._v(\"Action\")])])]),_c('tbody',_vm._l((_vm.users),function(user){return _c('tr',{key:user.id},[_c('th',{attrs:{\"scope\":\"row\"}},[_vm._v(_vm._s(user.id))]),_c('td',[_vm._v(_vm._s(user.email))]),_c('td',[_vm._v(_vm._s(user.isAdmin ? 'admin' : 'user'))]),_c('td',[(_vm.currentUser.id !== user.id)?_c('button',{staticClass:\"btn btn-link\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.toggleUserRole({userId:user.id,isAdmin:user.isAdmin})}}},[_vm._v(_vm._s(user.isAdmin ? 'set as user':'set as admin'))]):_vm._e()])])}),0)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container py-5\">\n    <!-- AdminNav Component -->\n    <AdminNav />\n\n    <Spinner v-if=\"isLoading\" />\n    <table v-else class=\"table\">\n      <thead class=\"thead-dark\">\n        <tr>\n          <th scope=\"col\">#</th>\n          <th scope=\"col\">Email</th>\n          <th scope=\"col\">Role</th>\n          <th scope=\"col\" width=\"180\">Action</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"user in users\" :key=\"user.id\">\n          <th scope=\"row\">{{user.id}}</th>\n          <td>{{user.email}}</td>\n          <td>{{ user.isAdmin ? 'admin' : 'user' }}</td>\n          <td>\n            <button\n              v-if=\"currentUser.id !== user.id\"\n              type=\"button\"\n              class=\"btn btn-link\"\n              @click.stop.prevent=\"toggleUserRole({userId:user.id,isAdmin:user.isAdmin})\"\n            >{{ user.isAdmin ? 'set as user':'set as admin'}}</button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport Spinner from './../components/Spinner'\nimport AdminNav from './../components/AdminNav'\nimport adminAPI from './../apis/admin'\nimport { Toast } from './../utils/helpers'\n\nexport default {\n  components: {\n    AdminNav,\n    Spinner\n  },\n  data() {\n    return {\n      users: [],\n      isLoading: true\n    }\n  },\n  computed: {\n    ...mapState(['currentUser'])\n  },\n  created() {\n    this.fetchUsers()\n  },\n  methods: {\n    async fetchUsers() {\n      try {\n        const { data, statusText } = await adminAPI.users.get()\n        if (statusText !== 'OK') {\n          throw new Error(statusText)\n        }\n        this.users = data.users\n        this.isLoading = false\n      } catch (error) {\n        this.isLoading = false\n        Toast.fire({\n          type: 'error',\n          title: '無法取得會員資料，請稍後再試'\n        })\n      }\n    },\n\n    async toggleUserRole({ userId, isAdmin }) {\n      try {\n        const willBeAdmin = !isAdmin\n        const { data, statusText } = await adminAPI.users.update({\n          userId,\n          isAdmin: willBeAdmin.toString()\n        })\n        if (statusText !== 'OK' || data.status !== 'success') {\n          throw new Error(statusText)\n        }\n        this.users = this.users.map(user => {\n          if (user.id !== userId) {\n            return user\n          }\n          return {\n            ...user,\n            isAdmin: willBeAdmin\n          }\n        })\n      } catch (error) {\n        Toast.fire({\n          type: 'error',\n          title: '無法更新會員角色，請稍後再試'\n        })\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUsers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AdminUsers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AdminUsers.vue?vue&type=template&id=65a1f23d&\"\nimport script from \"./AdminUsers.vue?vue&type=script&lang=js&\"\nexport * from \"./AdminUsers.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import {\n  apiHelper\n} from './../utils/helpers';\n\nexport default {\n  categories: {\n    get() {\n      return apiHelper.get('/admin/categories')\n    },\n    create({\n      name\n    }) {\n      return apiHelper.post('/admin/categories', {\n        name\n      })\n    },\n    update({\n      categoryId,\n      name\n    }) {\n      return apiHelper.put(`/admin/categories/${categoryId}`, {\n        name\n      })\n    },\n    delete({\n      categoryId\n    }) {\n      return apiHelper.delete(`/admin/categories/${categoryId}`)\n    },\n  },\n  restaurants: {\n    getDetail({\n      restaurantId\n    }) {\n      return apiHelper.get(`/admin/restaurants/${restaurantId}`)\n    },\n    get() {\n      return apiHelper.get('/admin/restaurants')\n    },\n    create({\n      formData\n    }) {\n      return apiHelper.post('/admin/restaurants', formData)\n    },\n    update({\n      restaurantId,\n      formData\n    }) {\n      return apiHelper.put(`/admin/restaurants/${restaurantId}`, formData)\n    },\n    delete({\n      restaurantId\n    }) {\n      return apiHelper.delete(`/admin/restaurants/${restaurantId}`)\n    },\n  },\n  users: {\n    get() {\n      return apiHelper.get('/admin/users')\n    },\n    update({\n      userId,\n      isAdmin\n    }) {\n      return apiHelper.put(`/admin/users/${userId}`, {\n        isAdmin\n      })\n    }\n  }\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"my-3\"},[_c('h1',[_vm._v(\"餐廳後台\")]),_c('div',{staticClass:\"mt-1\"},[_c('router-link',{staticClass:\"btn btn-link px-0\",attrs:{\"to\":\"/admin/restaurants\"}},[_vm._v(\"Restaurants\")]),_vm._v(\" |\\n    \"),_c('router-link',{staticClass:\"btn btn-link px-0\",attrs:{\"to\":\"/admin/categories\"}},[_vm._v(\"Categories\")]),_vm._v(\" |\\n    \"),_c('router-link',{staticClass:\"btn btn-link px-0\",attrs:{\"to\":\"/admin/users\"}},[_vm._v(\"Users\")])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AdminNav.vue?vue&type=template&id=6315f1d9&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}